// pages/EvaluationForm/EvaluationForm3.js
// const app = getApp()
// Page({
//   onLoad: function (option) {
//     this.setData({
//       result1: option.saPASI5
//     })
//     this.setData({
//       result2: option.PEST
//     })
//     this.setData({
//       result3: option.PsARisk
//     })
//     this.setData({
//       ID: option.ID
//     })
//     var dataList = option.result.split(';')
//     console.log(dataList.length)
//     this.setData({
//       data1: '1. '+ dataList[0]
//     })
//     this.setData({
//       data2: '2. ' + dataList[1]
//     })
//     this.setData({
//       data3: '3. ' + dataList[2]
//     })
//     this.setData({
//       data4: '4. ' + dataList[3]
//     })

//     //这里判断第一句话的背景颜色
//     if (this.data.data1.indexOf('没有')!= -1){
//       console.log("id:1")
//       var color = this.findcolor(1)
//       this.setData({
//         color1: color
//       })
//     } else if (this.data.data1.indexOf('轻度') != -1){
//       console.log("id:2")
//       var color = this.findcolor(2)
//       this.setData({
//         color1: color
//       })
//     } else if (this.data.data1.indexOf('中度') != -1) {
//       console.log("id:3")
//       var color = this.findcolor(3)
//       this.setData({
//         color1: color
//       })
//     } else if (this.data.data1.indexOf('极重度') != -1) {
//       console.log("id:5")
//       var color = this.findcolor(5)
//       this.setData({
//         color1: color
//       })
//       this.setData({
//         word1: 'white'
//       })
//     } else if (this.data.data1.indexOf('重度') != -1) {
//       console.log("id:4")
//       var color = this.findcolor(4)
//       this.setData({
//         color1: color
//       })
//       this.setData({
//         word1: 'white'
//       })
//     }

//     //这里判断第二句话的背景颜色
//     if (this.data.data2.indexOf('没有') != -1) {
//       console.log("id:1")
//       var color = this.findcolor(1)
//       this.setData({
//         color2: color
//       })
//     } else if (this.data.data2.indexOf('轻微') != -1) {
//       console.log("id:2")
//       var color = this.findcolor(2)
//       this.setData({
//         color2: color
//       })
//     } else if (this.data.data2.indexOf('相当') != -1) {
//       console.log("id:3")
//       var color = this.findcolor(3)
//       this.setData({
//         color2: color
//       })
//     } else if (this.data.data2.indexOf('极度') != -1) {
//       console.log("id:5")
//       var color = this.findcolor(5)
//       this.setData({
//         color2: color
//       })
//       this.setData({
//         word2: 'white'
//       })
//     } else if (this.data.data2.indexOf('十分') != -1) {
//       console.log("id:4")
//       var color = this.findcolor(4)
//       this.setData({
//         color2: color
//       })
//       this.setData({
//         word2: 'white'
//       })
//     }

//     if (dataList.length>4){
//       console.log("大于4")
//       if (dataList[4].indexOf('不太可能') != -1 || dataList[4].indexOf('可能性小') != -1) {
//         this.setData({
//           data5: '5. 您目前患银屑病关节炎的可能性较小，请继续注意关节症状。'
//         })
//       } else{
//         this.setData({
//           data5: '5. 您目前患银屑病性关节炎的可能性较大，建议您找专业医生进行诊治。'
//         })
//       }
      
//       this.setData({
//         data6: '6. ' + dataList[5]
//       })
//       this.setData({
//         data: true
//       })

//       //这里判断第五句话的背景颜色
//       if (dataList[4].indexOf('不太可能') != -1) {
//         console.log("id:1")
//         var color = this.findcolor(1)
//         this.setData({
//           color5: color
//         })
//       } else if (dataList[4].indexOf('可能性小') != -1) {
//         console.log("id:2")
//         var color = this.findcolor(2)
//         this.setData({
//           color5: color
//         })
//       } else if (dataList[4].indexOf('有些可能') != -1) {
//         console.log("id:3")
//         var color = this.findcolor(3)
//         this.setData({
//           color5: color
//         })
//       } else if (dataList[4].indexOf('非常可能') != -1) {
//         console.log("id:5")
//         var color = this.findcolor(5)
//         this.setData({
//           color5: color
//         })
//         this.setData({
//           word5: 'white'
//         })
//       } else if (dataList[4].indexOf('很有可能') != -1) {
//         console.log("id:4")
//         var color = this.findcolor(4)
//         this.setData({
//           color5: color
//         })
//         this.setData({
//           word5: 'white'
//         })
//       }

//       //这里判断第六句话的背景颜色
//       if (dataList[5].indexOf('不大') != -1) {
//         console.log("id:1")
//         var color = this.findcolor(1)
//         this.setData({
//           color6: color
//         })
//       } else if (dataList[5].indexOf('低风险') != -1) {
//         console.log("id:2")
//         var color = this.findcolor(2)
//         this.setData({
//           color6: color
//         })
//       } else if (dataList[5].indexOf('中风险') != -1) {
//         console.log("id:3")
//         var color = this.findcolor(3)
//         this.setData({
//           color6: color
//         })
//       } else if (dataList[5].indexOf('极高风险') != -1) {
//         console.log("id:5")
//         var color = this.findcolor(5)
//         this.setData({
//           color6: color
//         })
//         this.setData({
//           word6: 'white'
//         })
//       } else if (dataList[5].indexOf('高风险') != -1) {
//         console.log("id:4")
//         var color = this.findcolor(4)
//         this.setData({
//           color6: color
//         })
//         this.setData({
//           word6: 'white'
//         })
//       }
//     }
//   },


//   properties: {
//       //是否显示modal
//     show: {
//       type: Boolean,
//       value: false
//     },
//       //modal的高度
//     height: {
//       type: String,
//       value: '80%'
//     }
//   },

  
//   /**
//    * 页面的初始数据
//    */
//   data: {
//     result1: '',
//     result2: '',
//     result3: '',
//     result4: '',
//     value: '.',
//     show: false,
//     content: '',
//     data: false,
//     data1: '',
//     data2: '',
//     data3: '',
//     data4: '',
//     data5: '',
//     data6: '',
//     url: app.globalData.host + '/sendMessage',
//     ID: '',
//     color1: '',
//     color2: '',
//     color5: '',
//     color6: '',
//     word1: '',
//     word2: '',
//     word5: '',
//     word6: '',
//   },
//   findcolor: function(id){
//     var color
//     if(id==1){
//       color ='#00FF00'
//     }else if (id==2){
//       color = '#FFFF99'
//     } else if (id == 3) {
//       color = '#FFCC00'
//     } else if (id == 4) {
//       color = '#FF6600'
//     } else if (id == 5) {
//       color = '#EE0000'
//     }
//     return color
//   },

//   bindinput: function (e) {
//     console.log('输入的内容为', e.detail.value)
//     this.setData({
//       content: e.detail.value
//     })
//   },

//   formSubmit: function(e){
//     wx.reLaunch({
//       url: '/pages/index/index'
//     })
//   },

//   formSubmit1: function (e) {
//     this.setData({
//       show: true
//     })
//   },
  
//   clickMask() {
//     // this.setData({show: false})
//   },

//   cancel() {
//     this.setData({ show: false })
//   },

//   confirm() {
//     this.setData({ show: false })
//     this.pageload()
//   },

//   pageload: function () {
//     var result = false
//     //生成loading框
//     wx.showLoading({
//       title: '提交留言中',
//     })
//     result = this.httprequst();
//   },
  
//   httprequst: function () {
//     var that = this;
//     var result = false
//     console.log('发送请求')
//     wx.request({
//       url: this.data.url,
//       method: 'POST',
//       data: {
//         'message': this.data.content,//信息
//         'ID': this.data.ID
        
//       },
//       complete: function (res) {
//         console.log(res.data)
//         try {
//           // console.log(res.data.result)
//           if (res.data.result && res.data.result == 1) {
//             result = true
//           }
//           that.pagedone(result)
//         } catch (e) {
//           that.pagedone(result)
//         }
//       },
//     })
//   },

//   pagedone: function (result) {
//     //下面的是操作
//     wx.hideLoading()
//     if (result) {
//       console.log('服务端收到信息');
//       wx.showModal({
//         title: '成功',
//         content: '您已成功提交信息。'
//       })
//     } else {
//       wx.showModal({
//         title: '错误',
//         content: '信息提交失败，请重试'
//       })
//     }
//   },
//   /**
//    * 生命周期函数--监听页面加载
//    */
  
//   /**
//    * 生命周期函数--监听页面初次渲染完成
//    */
//   onReady: function () {
  
//   },

//   /**
//    * 生命周期函数--监听页面显示
//    */
//   onShow: function () {
  
//   },

//   /**
//    * 生命周期函数--监听页面隐藏
//    */
//   onHide: function () {
  
//   },

//   /**
//    * 生命周期函数--监听页面卸载
//    */
//   onUnload: function () {
  
//   },

//   /**
//    * 页面相关事件处理函数--监听用户下拉动作
//    */
//   onPullDownRefresh: function () {
  
//   },

//   /**
//    * 页面上拉触底事件的处理函数
//    */
//   onReachBottom: function () {
  
//   },

//   /**
//    * 用户点击右上角分享
//    */
//   onShareAppMessage: function () {
  
//   }
// })
const app = getApp();
Page({
  data: {},
  onLoad: function (options) {
    wx.showToast({
      title: '请关注公众号',
      icon: 'none',
      duration: 2000
    })
    console.log(options.code);
    if (options.code){
      this.setData({
        code: options.code
      })
    }
   
    // 页面初始化 options为页面跳转所带来的参数
    this.tempData();
  },
  getBase64ImageUrl: function () {
    let base64Data = this.data.code;
    if (base64Data ==undefined){
      wx.showModal({
        title: '您还未授权',
        content: '授权后自测信息可直接传达给医生，便于医生给出及时反馈',
        showCancel: false,
        success(res) {
          if (res.confirm) {
            wx.switchTab({
              url: '/pages/index/index',
            })
          }
        }
      })
    }else {
      this.setData({
        show: true,
        base64ImgUrl: "data:image/png;base64," + base64Data.replace(/[\r\n]/g, "")
      })
    }
    /// 获取到base64Data
   
    //console.log(JSON.stringify(base64Data))
    /*
    let base64Data = JSON.stringify(this.data.code);
    console.log(base64Data);
   
    /// 通过微信小程序自带方法将base64转为二进制去除特殊符号，再转回base64
    base64Data = wx.arrayBufferToBase64(wx.base64ToArrayBuffer(base64Data));
    base64Data = base64Data.replace("  ", "");
    /// 拼接请求头，data格式可以为image/png或者image/jpeg等，看需求
    const base64ImgUrl = "data:image/png;base64," + base64Data;
    /// 刷新数据
    this.setData({
      base64ImgUrl: base64ImgUrl
    })*/
  },
  //测试临时数据
  tempData: function () {
    var list = [{
      rank: "严重程度评分：",
      txtStyle: "",
      pace: "5",

    },
    {
      rank: "银屑病关节炎得分:",
      txtStyle: "",
      pace: "5",
    },
    {
      rank: "银屑病关节炎风险评估得分：",
      txtStyle: "",
      pace: "45",
    },
    {
      rank: "评估建议",
      txtStyle: "bold",
      name: "",
    },
    {
      rank: "1.您目前银屑病属于轻微",
      txtStyle: "",
      name: "",
    },
    {
      rank: "2.您的病情对您没有什么影响",
      txtStyle: "",
      name: "",
    },
    {
      rank: "3.建议您适当的治疗疾病",
      txtStyle: "",
      name: "",
    },
    {
      rank: "4.您目前没有被专业医师诊断为银屑病关节炎",
      txtStyle: "",
      name: "",
    }
    ]

    this.setData({
      list: list
    });
  },

  cancel() {
    this.setData({ show: false })
  },

  confirm() {
    this.setData({ show: false })
  },
  confirm: function () {
    var useinfo = app.globalData.userInfo;
    console.log(useinfo)
    if(!useinfo){
      wx.showModal({
        title: '您还未授权',
        content: '为了给您更好的服务以及确保信息的准确,系统建议您进行授权登录',
        showCancel: false,
        success(res) {
          if (res.confirm) {
            wx.switchTab({
              url: '/pages/index/index',
            })
          }
        }
      })
    }else{
      wx.redirectTo({
        url: '/pages/pages/personal1',
      })
    }
    

  }
})