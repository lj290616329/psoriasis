// pages/pages/EvaluationForm6.js
const app = getApp()
var domain = "https://tty.tsing-care.com/";
Page({

  /**
   * 页面的初始数据
   */
  data: {
    value:[],
    show: false,
    content: '',
  },
  formSubmit: function (e) {
    console.log(e)
    var _that = this;
    console.log(e.currentTarget.id)
    var unionid = app.globalData.unionid;
    var id = e.currentTarget.id
    wx.request({
      url: domain + `/wxs/evaluation/detail/${id}?unionid=${unionid}`,
      method: 'GET',
      complete: function (res) {
        console.log(res.data.code)
        let base64Data = res.data.code;
        /// 获取到base64Data
        _that.setData({
          show: true,
          base64ImgUrl: "data:image/png;base64," + base64Data.replace(/[\r\n]/g, "")
        })
      },
    })

    
    // console.log(this.data.value[id].propose)
    // var dateList = this.data.value[id].propose.split(';')
    // var contents = ''
    // var temp
    // for (var i in dateList) {
    //   temp = dateList[i] + '\r\n'
    //   contents = contents +temp;
    // }
    // this.setData({
    //   content: contents
    // })
    // this.setData({
    //   show: true
    // })
  },
  cancel() {
    this.setData({ show: false })
  },

  confirm() {
    this.setData({ show: false })
  },
  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
    var _that = this;
    //在这里获取数据
    var unionid = app.globalData.unionid;
    wx.request({
      url:domain + `/wxs/evaluation/list?unionid=${unionid}`,
      method: 'GET',
      data: {
        // 'IDNum': app.globalData.IDNum,//IDNum
        'Name': app.globalData.Name,//Name
        'id': 1,
      },

      complete: function (res) {
       
        var str = res.data.data;
        _that.setData({
          value: str
        })
      },
    })

  },
    
  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {
  
  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {
  
  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {
  
  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {
  
  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {
  
  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {
  
  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {
  
  }
})