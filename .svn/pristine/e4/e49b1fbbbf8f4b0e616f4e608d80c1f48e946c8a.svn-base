//app.js
var domain = "http://17240k68p1.51mypc.cn/";
App({
  globalData: {    
    if_test: true,
    if_doctor:false,
    unionid: '',
    userInfo: null,
    host: domain,
    //需要上传的数据
    data:{
      'datet1': null,//面积
      'datet2': null,//红斑
      'datet3': null,//鳞屑
      'datet4': null,//厚度
      'level': null,//生活质量评分
      'if_1': null,//关节炎相关情况1
      'if_2': null,//2
      'if_3': null,//3
      'if_4': null,//4
      'if_5': null,//5
      'if_6': null,//6
      'if_7': null,//7
      //新表
      'checkvalue1': null,//是否诊断银屑病
      'time1': null,//诊断银屑病时间
      'checkvalue2': null,//是否诊断银屑病关节炎
      'time2': null,//诊断银屑病关节炎时间
    }
  },
  onLaunch: function() {
    console.log("app.js---onLaunch");
    // 展示本地存储能力
    var logs = wx.getStorageSync('logs') || [];
    logs.unshift(Date.now());
    wx.setStorageSync('logs', logs);
    var that = this;
    //根据code获取openid等信息
    wx.login({
      success: function (res) {
        console.log(res);
        var code = res.code; //返回code
        wx.request({
          url: domain + '/wxs/rest/code2Session?code=' + code,
          method: 'get',
          dataType: 'json',
          success: function (response) {
            console.log(response);
            var result = response.data;
            if (result.errcode == 0) {
              that.globalData.unionid = result.unionid;
              if (result.if_doctor) {
                wx.reLaunch({
                  url: '/pages/pages/doctory',
                })
              } else {
                wx.reLaunch({
                  url: '/pages/pages/personal1'
                })
              }
            }else{
              wx.reLaunch({
                url: '/pages/index/index',
              })
            }
          }
        })
      }
    })
  },
})